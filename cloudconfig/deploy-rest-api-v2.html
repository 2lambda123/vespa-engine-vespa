<!DOCTYPE html>
<!-- Copyright 2016 Yahoo Inc. Licensed under the terms of the Apache 2.0 license. See LICENSE in the project root. -->
<html lang="en">

<head>
  <title>Multitenant Config REST API for deploying application packages</title>
  <link rel="stylesheet" href="http://vespa.corp.yahoo.com/css/vespadoc-standalone.css" />
  <meta name="date"    content="March 2016" />
  <meta name="authors" content="musum,lulf" />
</head>

<body>

<p>
This is the API specification and some examples for the
the second version of the HTTP REST API that can be used to deploy applications in a multitenant Cloud Config System.
The second version of the deployment API is very similar to the first, but now includes support for multiple tenants using the same config server for deploying applications. Each tenant may have multiple applications deployed in different environments and different regions, all of which can be deployed using this API.

For each tenant you can <a href="#create-session">upload</a>, <a href="#prepare-session">prepare</a>
and <a href="#activate-session">activate</a> applications. The response format is JSON.  In addition to the <a href="#apispec">API
specification</a> there is a <a
href="#use-case">use-case</a> giving practical examples of 
API usage.
</p>

<p>
The API is available on port 19071 on any host where a config server
is running. An example URL would be
<code>http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session</code>.
</p>

<h1 id="apispec">API Specification</h1>

<h2 id="general-notes">General Notes</h2>

<h3 id="version-number">Version Number</h3>

<p>
The current API version is 2.
</p>

<h3 id="error-handling">Error Handling</h3>

<p>
Errors are returned using standard HTTP response codes. Any additional
info is included in the body of the return call, JSON-formatted.

The general format for an error response is:
</p>

<pre>
{
    "error-code": "ERROR_CODE",
    "message": "An error message"
}
</pre>

<p>
where error-code might and message contains further
information about the error, as described in the table below.
</p>


<table>
  <thead>
    <tr>
      <th>HTTP response code</th>
      <th>error-code</th>
      <th>Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>400</td>
      <td>BAD_REQUEST</td>
      <td>Bad request. Client error. The error message should indicate the cause.</td>
    </tr>
    <tr>
      <td>400</td>
      <td>INVALID_APPLICATION_PACKAGE</td>
      <td>There is an error in the application package. The error message should indicate the cause.</td>
    </tr>
    <tr>
      <td>401</td>
      <td></td>
      <td>Not authorized. The error message should indicate the cause.</td>
    </tr>
    <tr>
      <td>404</td>
      <td>NOT_FOUND</td>
      <td>Not found. For example using a session id that doesn't exist.</td>
    </tr>
    <tr>
      <td>405</td>
      <td>METHOD_NOT_ALLOWED</td>
      <td>Method not implemented. E.g. using GET where only POST or PUT is allowed.</td>
    </tr>
    <tr>
      <td>500</td>
      <td>INTERNAL_SERVER_ERROR</td>
      <td>Internal server error. Generic error. The error message should indicate the cause.</td>
    </tr>
  </tbody>
</table>

<h3 id="tenant">Tenant</h3>

<p>
The tenant used in this API is created using the <a href="tenant-rest-api.html">tenant REST API</a>. The tenant name is required for all operations. Legal tenant names may only contain word characters <em>[a-zA-Z_0-9]</em>.
</p>

<h3 id="application">Application</h3>
<p>
The application is the name of the application taken from the application package or given during <a href="#prepare-session">prepare</a>.
Legal application names may only contain word characters <em>[a-zA-Z_0-9]</em>.
</p>

</p>

</p>

<h3 id="environment">Environment</h3>
<p>
Multiple environments are not yet supported. 'Default' is used.
</p>

<h3 id="region">Region</h3>
<p>
Multiple regions are not yet supported. 'Default' is used.
</p>

<h3 id="instance">Instance</h3>
<p>
Multiple instances are not yet supported. 'Default' is used.
</p>

<h3 id="session-id">Session id</h3>

<p>
The session id used in this API is generated by the server and is
required for all operations after <a
 href="#create-session">creating</a> a session.
The session id is valid as long as it is one of
the last 10 session ids created.
</p>

<h3 id="path">Path in request</h3>

<p>
An application file path in a request URL or parameter refers to a
relative path in the application package.  A path ending with '/'
refers to a directory.
</p>

<h3 id="multinode">Config server synchronization</h3>

<p>
All operations are synchronous across the cluster of config servers,
meaning that requests return after the operations complete on all servers.
</p>

<h2 id="create-session">POST /application/v2/tenant/[<a href="#tenant">tenant name</a>]/session</h2>

<p>
Creates a new session with the application package that is
included in the request.
</p>

<h3 id="create-get-params">Parameters</h3>
<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Default value</th>
      <th>Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>from</td>
      <td>N/A</td>
      <td>Should only be used when you want to create a session based
    on an active application. Valid values
    are a url to an active application.
    A new session will be created based on the corresponding application.
       </td>
    </tr>
  </tbody>
</table>

<h3 id="create-request-body">Request body</h3>

<table>
  <thead>
    <tr>
      <th>Required</th>
      <th>Content</th>
      <th>Note</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>Yes, unless <code>from</code> parameter is used</td>
      <td>A compressed <a href="application-packages.html">application
    package</a> (with gzip or zip compression)</td>
      <td> It is required to set the <code>Content-Type</code> HTTP
    header to <code>application/x-gzip</code> or <code>application/zip</code>, unless the
      <code>from</code> parameter is used.</td>
    </tr>
  </tbody>
</table>


<h3 id="create-session-response">Response</h3>
<p>
A response includes:
</p>

<ul>
  <li>A <a href="#session-id">session id</a> to the application that was created.</li>
  <li>A <a href="#prepare-session">prepare</a> URL for preparing
      that application.</li>
</ul>

<h3 id="create-session-example1">Sample Response: POST /application/v2/tenant/mytenant/session</h3>
<pre>
{
    "tenant": "mytenant",
    "session-id": "1",
    "prepared": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/<em>session-id</em>/prepared/",
    "content": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/<em>session-id</em>/content/",
    "message": "Session 1 for tenant 'mytenant' created."
}
</pre>

<h3 id="create-session-example2">Sample Response: POST /application/v2/tenant/mytenant/session?from=http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/application/myapp/environment/default/region/default/instance/default</h3>

(Same as above.)

<h2 id="content-put">PUT /application/v2/tenant/[<a href="#tenant">tenant name</a>]/session/[<a href="#session-id">session id</a>]/content/[<a href="#path">path</a>]</h2>

<p>
Writes the content to the given path, or creates a directory if the
path ends with '/'.
</p>

<h3 id="content-put-request-body">Request body</h3>
<p>
If path is a directory, None.
If path is a file, the contents of the file.
</p>

<h3 id="content-put-response">Response</h3>
<p>
None
</p>

<ul>
  <li>Any errors or warnings from writing the file/creating the directory.</li>
</ul>

<h2 id="content-get">GET /application/v2/tenant/[<a href="#tenant">tenant name</a>]/session/[<a href="#session-id">session id</a>]/content/[<a href="#path">path</a>]</h2>

<p>
Returns the content of the file at this path, or lists files and
directories if <code>path</code> ends with '/'.
</p>

<h3 id="content-get-params">Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Default value</th>
      <th>Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>recursive</td>
      <td>false</td>
      <td>If true, directory content will be listed recursively.</td>
    </tr>
    <tr>
      <td>return</td>
      <td>content</td>
      <td><ul><li>If set to content and path refers to a file, the content will be
      returned.</li>
      <li>If set to content and path refers to a directory, the files and
      subdirectories in the directory will be listed.</li>
      <li>If set to status and path refers to a file, the file status and hash will
      be returned.</li>
      <li>If set to status and path refers to a directory, a list of file/subdirectory
      statuses and hashes will be returned.</li>
      </ul>
      </td>
    </tr>
  </tbody>
</table>

<h3 id="content-get-response">Response</h3>

<p>
If path is a directory: a JSON array of URLs to the files and subdirectories of
that directory.
If path is a file: the contents of the file.
If status parameter is set, the status and hash will be returned.
</p>

<h3 id="content-get-example1">Sample Response: GET /application/v2/tenant/mytenant/session/3/content/</h3>

<pre>
[
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/hosts.xml",
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/services.xml",
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/searchdefinitions/"
]
</pre>

<h3 id="content-get-example2">Sample Response: GET /application/v2/tenant/mytenant/session/3/content/?recursive=true</h3>

<pre>
[
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/hosts.xml",
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/services.xml",
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/searchdefinitions/",
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/searchdefinitions/music.sd",
    "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/searchdefinitions/video.sd"
]
</pre>

<h3 id="content-get-example3">Sample Response: GET /application/v2/tenant/mytenant/session/3/content/hosts.xml</h3>

<pre>
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;hosts&gt;
  &lt;host name="myhost.mydomain.com"&gt;
    &lt;alias&gt;vespa1&lt;/alias&gt;
  &lt;/host&gt;
  &lt;host name="myhost.mydomain.com"&gt;
    &lt;alias&gt;vespa2&lt;/alias&gt;
  &lt;/host&gt;
&lt;/hosts&gt;
</pre>

<h3 id="content-get-example4">Sample Response: GET /application/v2/tenant/mytenant/session/3/content/hosts.xml?return=status</h3>

<pre>
{
    "name": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/hosts.xml",
    "status": "new",
    "md5": "03d7cff861fcc2d88db70b7857d4d452"
}
</pre>

<h3 id="content-get-example5">Sample Response: GET /application/v2/tenant/mytenant/session/3/content/searchdefinitions/?return=status</h3>

<pre>
[
    {
        "name": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/searchdefinitions/music.sd",
        "status": "new",
        "md5": "03d7cff861fcc2d88db70b7857d4d452"
    },
    {
        "name": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/searchdefinitions/video.sd",
        "status": "changed",
        "md5": "03d7cff861fcc2d88db70b7857d4d452"
    },
    {
        "name": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/content/searchdefinitions/book.sd",
        "status": "deleted",
        "md5": "03d7cff861fcc2d88db70b7857d4d452"
    }
]
</pre>

<h2 id="content-delete">DELETE /application/v2/tenant/[<a href="#tenant">tenant name</a>]/session/[<a href="#session-id">session id</a>]/content/[<a href="#path">path</a>]</h2>

<p>
Deletes the resource at the given path.
</p>

<h3 id="content-delete-request-body">Request body</h3>
<p>
None
</p>

<h3 id="content-delete-response">Response</h3>

<p>
Any errors or warnings from deleting the resource.
</p>

<h2 id="prepare-session">PUT /application/v2/tenant/[<a href="#tenant">tenant name</a>]/session/[<a href="#session-id">session id</a>]/prepared</h2>

<p>
Prepares an application with the <a href="#session-id">session id</a> given.
</p>

<h3 id="prepare-put-params">Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Default value</th>
      <th>Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>applicationName</td>
      <td>N/A</td>
      <td>Name of the application to be deployed</td>
    </tr>
    <tr>
      <td>environment</td>
      <td>default</td>
      <td>Environment where application should be deployed</td>
    </tr>
    <tr>
      <td>region</td>
      <td>default</td>
      <td>Region where application should be deployed</td>
    </tr>
    <tr>
      <td>instance</td>
      <td>default</td>
      <td>Name of application instance</td>
    </tr>
    <tr>
      <td>debug</td>
      <td>false</td>
      <td>If true, include stack trace in response if prepare fails.</td>
    </tr>
    <tr>
      <td>timeout</td>
      <td>300 seconds</td>
      <td>Timeout in seconds to wait for session to be prepared.</td>
    </tr>
  </tbody>
</table>

<h3 id="prepare-session-request-body">Request body</h3>

<p>
None.
</p>

<h3 id="prepare-session-response">Response</h3>

<p>
Returns a <a href="#session-id">session id</a> and a link to activate the session.
</p>

<ul>
  <li>Log with any errors or warnings from preparing the application.</li>
  <li>An <a href="#activate-session">activate</a> URL for activating
      the application with this <a href="#session-id">session id</a>, if there were no
      errors.</li>
      <li>A list of actions (possibly empty) that must be performed in order to apply some config changes
      between the current active application and this next prepared application.
      These actions are organized into two categories; restart and refeed.
  <ul>
      <li>Restart actions are done after the application has been activated and are handled by restarting all listed services.
      Please see <a href="../changing-live-searchdefinitions.html#restart-no-flush">Changes that require restart</a>
      for more information.
      </li>
      <li>Refeed actions require several steps to handle.
      Please see <a href="../changing-live-searchdefinitions.html#refeed">Changes that require re-feeding</a>
      for more information.
      </li>
  </ul>
  </li>
</ul>

<h3 id="prepare-session-example1">Sample Response: PUT /application/v2/tenant/mytenant/session/3/prepared</h3>

<pre>
{
    "tenant": "mytenant",
    "activate": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/session/3/active",
    "message": "Session 3 for tenant 'mytenant' prepared.",
    "log": [
           { "level": "WARNING",
             "message": "Warning message 1",
             "time": 1430134091319
           },
           { "level": "WARNING",
             "message": "Warning message 2",
             "time": 1430134091320
           }
        ],
    "configChangeActions": {
        "restart": [ {
            "clusterName": "mycluster",
            "clusterType": "search",
            "serviceType": "searchnode",
            "messages": [ "Document type 'test': Field 'f1' changed: add attribute aspect" ],
            "services": [ {
                "serviceName": "searchnode",
                "serviceType": "searchnode",
                "configId": "mycluster/search/cluster.mycluster/0",
                "hostName": "myhost.mydomain.com"
            } ]
        } ],
        "refeed": [ {
            "documentType": "test",
            "clusterName": "mycluster",
            "messages": [ "Document type 'test': Field 'f1' changed: add index aspect" ],
            "services": [ {
                "serviceName": "searchnode",
                "serviceType": "searchnode",
                "configId": "mycluster/search/cluster.mycluster/0",
                "hostName": "myhost.mydomain.com"
            } ]
        } ]
    }
}
</pre>

<h2 id="get-prepare-session">GET /application/v2/tenant/mytenant/session/[<a href="#session-id">session id</a>]/prepared</h2>

<p>
Returns the state of a prepared session.
</p>

<h3 id="prepare-session-example1">Sample Response</h3>

<p>
Same as a successful <a href="#prepare-session-example1">prepare</a> operation.
Note that the list of config change actions will always be empty in this response.
</p>

<h2 id="activate-session">PUT /application/v2/tenant/[<a href="#tenant">tenant name</a>]/session/[<a href="#session-id">session id</a>]/active</h2>

<p>
Activates an application with the <a
href="#session-id">session id</a> given. The
<a href="#session-id">session id</a> must be for a <a
href="#prepare-session">prepared session</a>. The operation will make
sure the session is activated on all config servers, if you have
configured more than one.
</p>

<h3 id="activate-params">Parameters</h3>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Default value</th>
      <th>Description</th>
    </tr>
  </thead>

  <tbody>
    <tr>
      <td>timeout</td>
      <td>60 seconds</td>
      <td>Timeout in seconds to wait for session to be activated (when
          several config servers are used, they might need to sync
          before activate can be done).</td>
    </tr>
  </tbody>
</table>

<h3 id="activate-session-response">Response</h3>

<p>
Returns a <a href="#session-id">session id</a>, a message and a URL to the activated application.
</p>

<ul>
  <li><a href="#session-id">session id</a></li>
  <li>Message</li>
</ul>

<h3 id="activate-session-example1">Sample Response: PUT /application/v2/tenant/mytenant/session/3/active</h3>

<pre>
{
    "tenant": "mytenant",
    "message": "Session 3 for tenant 'mytenant' activated.",
    "url": "http://myconfigserver.mydomain.com:19071/application/v2/tenant/mytenant/application/myapp/environment/default/region/default/instance/default"
}
</pre>



<h2 id="get-application">GET /application/v2/tenant/[<a href="#tenant">tenant name</a>]/application/</h2>

<p>
Returns a list of the currently active applications for the given
tenant
</p>


<h3 id="get-application-response">Response</h3>

<p>
Returns a list of applications
</p>

<ul>
  <li>Array of active applications</li>
</ul>

<h3 id="get-application-example1">Sample Response: GET /application/v2/tenant/mytenant/application/</h3>

<pre>
{
    ["http://myconfigserver.mydomain.com:19071/application/v2/tenant/default/application/default/environment/default/region/default/instance/default"]
}
</pre>




<h2 id="get-application-info">GET /application/v2/tenant/[<a href="#tenant">tenant name</a>]/application/[<a href="#application">application name</a>]</h2>

<p>
Gets info about the application.
</p>


<h3 id="get-application-info-response">Response</h3>

<p>
Returns information about the application specified.
</p>

<ul>
  <li>config generation</li>
</ul>

<h3 id="get-application-info-example1">Sample Response: GET /application/v2/tenant/mytenant/application/foo</h3>

<pre>
{
    "generation": 2
}
</pre>


<h2 id="delete-application">DELETE /application/v2/tenant/[<a href="#tenant">tenant name</a>]/application/[<a href="#application">application name</a>]</h2>

<p>
Deletes an active application
</p>


<h3 id="delete-application-response">Response</h3>

<p>
Returns a message stating if the operation was successful or not
</p>

<ul>
  <li>Message</li>
</ul>

<h3 id="delete-application-example1">Sample Response: DELETE /application/v2/tenant/mytenant/application/foo</h3>

<pre>
{
    "message": "Application 'foo' was deleted"
}
</pre>



<h2 id="get-host-info">GET /application/v2/host/[hostname]</h2>

<p>
Gets information about which tenant and application a hostname is used
by.
</p>


<h3 id="get-host-info-response">Response</h3>

<p>
Returns a message with tenant and application details.
</p>

<ul>
  <li>Message</li>
</ul>

<h3 id="get-host-info-example1">Sample Response: GET /application/v2/host/myhost.mydomain.com</h3>

<pre>
{
    "tenant":"mytenant"
    "application":"foo"
    "environment":"test"
    "region":"Europe"
    "instance":"1"
}
</pre>


<h1 id="use-case">Use Case: Using REST API to deploy, change and redeploy an application</h1>

<p>
This section shows a step-by-step run of deploying an application,
doing changes to the application and deploying the changed
application. In this example, we will use curl as the HTTP client. It is assumed that we have
created the tenant 'mytenant'.
</p>

<p>
The easiest way to deploy is by using the <code>deploy</code> tool. The following examples serve to illustrate the underlying REST API.

<h2 id="use-case-start">Create, prepare and activate an application</h2>

<p>
The application resides in app/ in the local file system. Now,
create a session with the application package:
</p>

<pre>
tar -C app -cf - . | gzip | curl -s --header "Content-Type:
application/x-gzip" --data-binary @-
http://host:19071/application/v2/tenant/mytenant/session
</pre>

<p>Response:</p>

<p>(See reference above.)

<p>
Prepare the application with the URL in the <em>prepared</em> link
from the response above:
</p>

<pre>
curl -s -X PUT "http://host:19071/application/v2/tenant/mytenant/session/1/prepared?applicationName=fooapp"
</pre>

<p>
Response:
</p>

<p>(See reference above.)

<p>
and finally, activate the application with the URL in the <em>activate</em> link
from the response above::
</p>

<pre>
curl -s -X PUT "http://host:19071/application/v2/tenant/mytenant/session/1/active"
</pre>

<p>The response shows that session 1 has been activated:</p>

<p>(See reference above.)

<h2 id="use-case-modify">Modify the application package</h2>

<p>The <em>services.xml</em> from session 1 can be viewed:</p>

<pre>
curl -s -X GET http://host:19071/application/v2/tenant/mytenant/session/1/content/services.xml
</pre>

<pre>
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;services version="1.0"&gt;

  &lt;admin version="2.0"&gt;
    &lt;config name="config.logd"&gt;
      &lt;logserver&gt;
        &lt;port&gt;12345&lt;/port&gt;
      &lt;/logserver&gt;
    &lt;/config&gt;
    &lt;adminserver hostalias="node1" /&gt;    
  &lt;/admin&gt;

&lt;/services&gt;
</pre>

<p>Now, we want to make some changes to the application package,
and prepare and activate a new session. Session 1 is activated and cannot
be changed.  To create a new session based on the active session we do:
</p>

<pre>
curl -s -X POST "http://host:19071/application/v2/tenant/mytenant/session?from=http://host:19071/application/v2/tenant/mytenant/application/fooapp/environment/default/region/default/instance/default"
</pre>

<p>and get the response:</p>

<p>
(See reference above.)

<p>
Now, we change the <em>services.xml</em>
file in the local file system so that the port number for the logserver is 12346 instead of 12345
and change the file for this session by doing:
</p>

<pre>
curl -s -X PUT --data-binary @app/services.xml 
"http://host:19071/application/v2/tenant/mytenant/session/2/content/services.xml"
</pre>

<p>Retrieving <em>services.xml</em> from session 2 we can see that it has the
updated content:</p>

<pre>
curl -s -X GET http://host:19071/application/v2/tenant/mytenant/session/2/content/services.xml
</pre>

<pre>
&lt;?xml version="1.0" encoding="utf-8" ?&gt;
&lt;services version="1.0"&gt;

  &lt;admin version="2.0"&gt;
    &lt;config name="config.logd"&gt;
      &lt;logserver&gt;
        &lt;port&gt;12346&lt;/port&gt;
      &lt;/logserver&gt;
    &lt;/config&gt;
    &lt;adminserver hostalias="node1" /&gt;    
  &lt;/admin&gt;

&lt;/services&gt;
</pre>

<p>Now, we want to add the file <em>files/test1.txt</em>. We do that
by first creating a directory:</p>

<pre>
curl -s -X PUT "http://host:19071/application/v2/tenant/mytenant/session/2/content/files/"
</pre>

<p>Then,  we add the file <em>files/test1.txt</em></p>
<pre>
curl -s -X PUT --data-binary @app/files/test1.txt 
"http://host:19071/application/v2/tenant/mytenant/session/2/content/files/test1.txt"
</pre>

<p> Now we can prepare the session:</p>
<pre>
curl -s -X PUT "http://host:19071/application/v2/tenant/mytenant/session/2/prepared?applicationName=fooapp"
</pre>

<p>and finally, activate the session:</p>
<pre>
curl -s -X PUT "http://host:19071/application/v2/tenant/mytenant/session/2/active"
</pre>

<h2 id="use-case-rollback">Rollback</h2>
<p>
Say that you find out that the changes done in the latest application did not work
out as expected and you want to rollback to a previous state known
to work. This is achieved by having multiple instance of an application. To rollback,
simply create a new session passing the previous instance as the from argument.

TODO: Need multiple instances to support this.
</p>

<h1 id="log">Audit log for REST API Calls</h1>

<p>
The log files for calls to the REST API are named
configserver.&lt;timestamp&gt; and can be found in
<em>$VESPA_HOME/logs/vespa/configserver/access.log</em>. The
format is the same as for the <a
 href="reference/logs.html#queryaccesslog">container access log</a>.
Example log entry:
</p>

<pre>
10.76.246.20 - - [31/Jan/2013:22:05:45 +0000] "PUT /application/v2/tenant/mytenant/session/1/active HTTP/1.1" 200 1238 "" "Mozilla/5.0 (Macintosh; Intel Mac OS X 10.7; rv:18.0) Gecko/20100101 Firefox/18.0" 1359669945.93 1 0.0 1
</pre>

<h1 id="finding-config-server">Finding the Config Server to Use</h1>

<p>
The default port number is 19071. You can get the URL to use for this
API by running <em>vespa-model-inspect -u service
configserver</em>
</p>

</body>
</html>
